title: '[Edit Preview] amine_roundtrip_test'
warehouse_id: 862f1d757f0424f7
description: Genie space for qld_arrow demo with curated questions and SQL instructions
version: 2
data_sources:
  tables:
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_events
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_timeseries_daily
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_type_comparison
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_asset_health_daily
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_maintenance_backlog
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_operational_events
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_safety_compliance_weekly
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_supply_impact_daily
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.gold_supply_kpis_daily
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.silver_assets
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.silver_inspections
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.silver_safety_incidents
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.silver_telemetry
  - identifier: demo_generator.rakesh_cherukuri_qld_arrow.silver_work_orders
instructions:
  text_instructions:
  - id: 01f0f000000000010000000000000000
    content: |-
      This Genie space supports self-serve analysis for Arrow Energy operations reliability and safety across Surat and Bowen basins (QLD). Use gold tables for executive-ready KPIs and drilldowns.

      Data model (gold-first):
      - Anomalies (atomic): gold_anomaly_events (one row per anomaly reading; filter by severity/anomaly_type/basin/locality/asset_class).
      - Anomaly KPIs: gold_anomaly_timeseries_daily (daily counts by basin).
      - Anomaly composition: gold_anomaly_type_comparison (pre_event vs spike comparison by anomaly_type).
      - Supply reliability: gold_supply_kpis_daily (delivered vs nominated and shortfall by basin/offtake/day).
      - Business exposure: gold_supply_impact_daily (shortfall_tj * constant price_per_tj; includes cumulative_exposure_usd).
      - Asset risk ranking: gold_asset_health_daily (health_score 0â€“100; lower is worse; includes high_anomaly_count_7d and open_work_orders).
      - Root-cause narrative: gold_operational_events (includes the key 2026-01-17 control_change and 2026-01-23 rollback).
      - Latest state for map-style questions: gold_latest_asset_state (latest reading per asset x sensor_type).

      Business logic notes:
      - High-severity anomalies: severity = 'high'.
      - Spike window: 2026-01-18 to 2026-01-22; pre-event reference week: 2026-01-10 to 2026-01-17.
      - Exposure uses price_per_tj=20000.0 (synthetic constant).

      Querying guidance:
      - Prefer gold_anomaly_timeseries_daily for time series; use gold_anomaly_events for locality/asset drilldowns.
      - For "last 48 hours" questions, anchor the window to MAX(event_ts) from the relevant table (data is historical).

      Data quality considerations:
      - silver_telemetry_quarantine holds non-good telemetry; gold tables are built from validated 'good' telemetry only.
      - Some metrics in asset health and compliance may reflect synthetic/demo artifacts; treat as directional for demo storytelling.
  example_question_sqls:
  - id: 01f0f000000000020000000000000000
    question: Daily high-severity anomaly trend (by basin)
    sql: -- High-severity anomalies per day by basin (drives the main spike view)SELECT  event_date,  basin,  high_anomaly_count,  total_anomaly_count,  distinct_assets_affectedFROM
      demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_timeseries_dailyWHERE
      event_date BETWEEN DATE('2026-01-01') AND DATE('2026-01-31')ORDER BY event_date,
      basin;
  - id: 01f0f000000000030000000000000000
    question: High-severity anomalies by locality and anomaly type (spike window)
    sql: -- Break down the spike window to find where/what is driving high severitySELECT  basin,  locality,  anomaly_type,  COUNT(*)
      AS high_eventsFROM demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_eventsWHERE
      severity = 'high'  AND event_date BETWEEN DATE('2026-01-18') AND DATE('2026-01-22')GROUP
      BY basin, locality, anomaly_typeORDER BY high_events DESC;
  - id: 01f0f000000000040000000000000000
    question: Dalby compressor stations with recent high vibration
    sql: -- Compressor stations in Dalby with high_vibration in last 48 hours of available
      data-- (Uses max event_ts in the table as the reference 'now')WITH max_ts AS
      (  SELECT MAX(event_ts) AS max_event_ts  FROM demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_events),
      windowed AS (  SELECT a.*  FROM demo_generator.rakesh_cherukuri_qld_arrow.gold_anomaly_events
      a  CROSS JOIN max_ts  WHERE a.event_ts >= max_ts.max_event_ts - INTERVAL 48
      HOURS    AND a.locality = 'Dalby'    AND a.asset_class = 'compressor_station'    AND
      a.anomaly_type = 'high_vibration'    AND a.severity IN ('high','medium'))SELECT  asset_id,  asset_name,  COUNT(*)
      AS events,  MAX(model_score) AS max_model_score,  MAX(sensor_value) AS max_vibration_mm_s,  MAX(event_ts)
      AS last_event_tsFROM windowedGROUP BY asset_id, asset_nameORDER BY max_model_score
      DESC, events DESC;
  - id: 01f0f000000000050000000000000000
    question: Delivered vs nominated and shortfall (by basin)
    sql: -- Basin-level delivered vs nominated and shortfallSELECT  schedule_date,  basin,  SUM(nominated_tj)
      AS nominated_tj,  SUM(delivered_tj) AS delivered_tj,  SUM(shortfall_tj) AS shortfall_tjFROM
      demo_generator.rakesh_cherukuri_qld_arrow.gold_supply_kpis_dailyWHERE schedule_date
      >= DATE('2026-01-01')GROUP BY schedule_date, basinORDER BY schedule_date, basin;
  - id: 01f0f000000000060000000000000000
    question: Spike-window cumulative shortfall and exposure (all basins)
    sql: -- Shortfall and exposure during the spike windowSELECT  schedule_date,  SUM(shortfall_tj)
      AS shortfall_tj,  SUM(exposure_usd) AS exposure_usdFROM demo_generator.rakesh_cherukuri_qld_arrow.gold_supply_impact_dailyWHERE
      schedule_date BETWEEN DATE('2026-01-18') AND DATE('2026-01-22')GROUP BY schedule_dateORDER
      BY schedule_date;-- Total for the windowSELECT  SUM(shortfall_tj) AS total_shortfall_tj,  SUM(exposure_usd)
      AS total_exposure_usdFROM demo_generator.rakesh_cherukuri_qld_arrow.gold_supply_impact_dailyWHERE
      schedule_date BETWEEN DATE('2026-01-18') AND DATE('2026-01-22');
